<!-- Copyright(C) 2015 Interactive Health Solutions, Pvt. Ltd.

This program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as
published by the Free Software Foundation; either version 3 of the License (GPLv3), or any later version.
This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with this program; if not, write to the Interactive Health Solutions, info@ihsinformatics.com
You can also access the license on the internet at the address: http://www.gnu.org/licenses/gpl-3.0.html

Interactive Health Solutions, hereby disclaims all copyright interest in this program written by the contributors.

Contributors: Tahira Niazi -->
<htmlform>
	<br/>
	<!-- Autogenerated example form  (template from 01-Nov-2010 -->
	<macros>
		paperFormId = (Fill this in)
		headerColor =#009d8e
		fontOnHeaderColor = white
	</macros>
	<style>
		.section {
			border: 1px solid $headerColor;
			padding: 2px;
			text-align: left;
			margin-bottom: 1em;
		}
		.sectionHeader {
			background-color: $headerColor;
			color: $fontOnHeaderColor;
			display: block;
			padding: 2px;
			font-weight: bold;
		}
		table.baseline-aligned td {
			vertical-align: baseline;
		}
	</style>

	<span style="float:right">Paper Form ID: $paperFormId</span>
	<h2>First Encounter Form for TB (v1.0)</h2>
	<section headerLabel="1. Encounter Details">
		<table class="baseline-aligned">
			<tr>
				<td>Form Date:</td>
				<td>
					<encounterDate default="today"/>
				</td>
			</tr>
			<tr>
				<td>Location:</td>
				<td>
					<encounterLocation default="1"/>
				</td>
			</tr>
			<tr>
				<td>Provider:</td>
				<td>
					<encounterProvider default="currentUser"/>
				</td>
			</tr>
		</table>
	</section>

	<section headerLabel="2. Patient Information">
		<div>
			<p>
				Address: <lookup expression="patient.personAddress.address1" />, <lookup expression="patient.personAddress.cityVillage" />, <lookup expression="patient.personAddress.country" />
			</p>
			<p>
				Contact(s): <lookup expression="personAttributes.get('Primary Mobile')"/>
			</p>
		</div>
	</section>

	<section headerLabel="3. Test Results">
		<div>
			<p>
				<lookup expression="fn.getConcept('77').description"/>:<b><lookup expression="fn.latestObs(77).valueCoded.name"/></b>
			</p>
			<p>
				<lookup expression="fn.getConcept('78').description"/>:<b><lookup expression="fn.latestObs(78).valueCoded.name"/></b>
			</p>
			<p>
				<lookup expression="fn.getConcept('114').description"/>:<b><lookup expression="fn.latestObs(114).valueCoded.name"/></b>
			</p>
			<p>
				<lookup expression="fn.getConcept('115').description"/>:<b><lookup expression="fn.latestObs(115).valueCoded.name"/></b>
			</p>
			<p>
				<lookup expression="fn.getConcept('116').description"/>:<b><lookup expression="fn.latestObs(116).valueCoded.name"/></b>
			</p>
			<p>
				<lookup expression="fn.getConcept('168').description"/>:<b><lookup expression="fn.latestObs(168).valueCoded.name"/></b>
			</p>
		</div>
	</section>
	
	<section headerLabel="4. Treatment">
		<div>
			<p>
				<lookup expression="fn.getConcept('285').description"/><br/>
				<obs conceptId="285" id="treatment_enrollment" answerConceptIds="1,2" defaultValue="1" style="radio"/>				
			</p>
			<div id="treatment_div">
				<p>
					Current Weight (kg): <lookup expression="fn.latestObs(22).valueNumeric"/>
				</p>
				<p>
					<lookup expression="fn.getConcept('22').description"/><br/>
					<obs conceptId="22" id="weight" size="3"/>
				</p>
				<div id="female_div">
					<p>
						<lookup expression="fn.getConcept('286').description"/><br/>
						<obs conceptId="286" id="pregnant" defaultValue="2"/>
					</p>
					<p>
						<lookup expression="fn.getConcept('287').description"/><br/>
						<obs conceptId="287" id="breastfeeding" defaultValue="2"/>
					</p>
				</div>
				<p>
					<lookup expression="fn.getConcept('288').description"/><br/>
					<obs conceptId="288" id="renal_disease" defaultValue="2"/>
				</p>
				<p>
					<lookup expression="fn.getConcept('289').description"/><br/>
					<obs conceptId="289" id="liver_disease" defaultValue="2"/>
				</p>
				<p>
					<lookup expression="fn.getConcept('108').description"/><br/>
					<obs conceptId="108" id="tb_medication_history" defaultValue="2"/>
				</p>
				<div id="streptomycin_div">
					<p>
						<lookup expression="fn.getConcept('109').description"/><br/>
						<obs conceptId="109" id="streptomycin_history" defaultValue="2"/>
					</p>
					<p>
						<lookup expression="fn.getConcept('381').description"/><br/>
						<obs conceptId="381" id="tx_duration"/><obs conceptId="382" id="tx_duration_modifier" defaultValue="193"/>
					</p>
				</div>
				<p>
					<lookup expression="fn.getConcept('290').description"/><br/>
					<obs conceptId="290" id="registration_group" defaultValue="291"/>
				</p>
				<p>
					<lookup expression="fn.getConcept('297').description"/><br/>
					<obs conceptId="297" id="tb_category" defaultValue="295"/>
				</p>
				<div id="contradiction_div">
					<p>
						<lookup expression="fn.getConcept('298').description"/><br/>
						<obs conceptId="298" id="regimen_contraindication" defaultValue="2"/>
					</p>
				</div>
				<p>
					<lookup expression="fn.getConcept('301').description"/><br/>
					<obs conceptId="301" id="treatment_phase"/>
				</p>
				<div id="regimen_serial_div">
					<p>
						<lookup expression="fn.getConcept('319').description"/><br/>
						<obs conceptId="319" id="regimen_serial"/>
					</p>
				</div>
				<p>
					<lookup expression="fn.getConcept('320').description"/><br/>
					<obs conceptId="320" id="treatment_centre" defaultValue="317"/>
				</p>
				<p>
					<lookup expression="fn.getConcept('322').description"/><br/>
					<obs conceptId="322" id="drug_site" defaultValue="321"/>
				</p>
			</div>
		</div>
	</section>
	<submit/>
	
	<script type="text/javascript">
		if(jQuery) {
		$j(document).ready(function() {
			// If gender is male, then hide Pregnancy and Breastfeeding questions
			var gender = "<lookup expression="patient.gender"/>";
			var femaleDiv = $j("#female_div");
			if (gender == "M") {
				femaleDiv.hide();
			}
			$j("#treatment_enrollment").change(function() {
				var treatmentDiv = $j("#treatment_div");
				var txEnrollmentValue = getValue('treatment_enrollment.value');
				if (txEnrollmentValue == 1) {
					treatmentDiv.show();
				}
				else {
					treatmentDiv.hide();
				}
			});
			$j("#treatment_enrollment").change();
			$j("#tb_medication_history").change(function() {
				var streptomycinDiv = $j("#streptomycin_div");
				var tbMedicationValue = getValue('tb_medication_history.value');
				if (tbMedicationValue == 1) {
					streptomycinDiv.show();
				}
				else {
					streptomycinDiv.hide();
				}
			});
			$j("#tb_medication_history").change();
			// If Category is Cat 2 and Patient is currently Pragnency or Breastfeeding, the set contraindication to Yes
			$j("#pregnant").change(function() {
				var pregnantValue = getValue('pregnant.value');
				if (pregnantValue == 1) {
					setValue('regimen_contraindication.value', 1);
				}
			});
			$j("#pregnant").change();
			$j("#breastfeeding").change(function() {
				var breastfeedingValue = getValue('breastfeeding.value');
				if (breastfeedingValue == 1) {
					setValue('regimen_contraindication.value', 1);
				}
			});
			$j("#breastfeeding").change();
			$j("#tb_category").change(function() {
				var tbCategoryValue = getValue('tb_category.value');
				if (tbCategoryValue == 296) {
					setValue('regimen_contraindication.value', 1);
				}
			});
			$j("#tb_category").change();
			$j("#regimen_contraindication").change(function() {
				var regimenSerialDiv = $j("#regimen_serial_div");
				var contraindicationValue = getValue('regimen_contraindication.value');
				if (contraindicationValue == 1) {
					regimenSerialDiv.hide();
				}
				else {
					regimenSerialDiv.show();
				}
			});
			$j("#regimen_contraindication").change();
		});
	}
	</script>
</htmlform>
